---
title: "Dictionary of the Tukita"
format: html
editor: source
css: styles.css
editor_options: 
  chunk_output_type: console
---

```{r}
#| include: false
knitr::opts_chunk$set(echo = FALSE)
```

The dictionary was compiled in 2020 by P. Magomedgadzhieva and M. Daniel (Linguistic Convergence Laboratory, HSE University) and afterwords corrected in 2023. The online version originally was created by V. Morozova and then remade by G. Moroz. The compilation of the dictionaries was supported by the University of Jena and by the Basic Research Program at the National Research University "Higher School of Economics" (HSE) as part of the Russian Academic Excellence Project '5-100'.

Please refer to the dictionary as follows:

```{r}
library(RefManageR)
BibOptions(check.entries = FALSE, style = 'text', bib.style = 'authoryear')
article_citation <- BibEntry(bibtype = 'misc', 
 key='magomedgadzhieva2023',
 title='Dictionary of the Tukita (v2.0.0)',
 author='Patimat Magomedgazhieva and Michael Daniel',
 year='2023',
 publisher='Linguistic Convergence Laboratory, NRU HSE',
 address='Moscow',
 url='http://lingconlab.ru/TukitaDict/')
```

::: {.panel-tabset}

### Plain text
```{r, results = 'asis'}
print(article_citation, .opts = list(style = 'text'))
```

### BibTeX

```{r}
print(article_citation, .opts = list(style = 'Bibtex'))
```

:::

```{r}
#| echo: false
#| warning: false

library(tidyverse)
library(DT)
library(glue)

js_initComplete <- c(
  "function(settings){",
  "  var instance = settings.oInstance;",
  "  var table = instance.api();",
  "  var input = instance.parent().find('.dataTables_filter input');",
  "  input.off('keyup search input').on('keyup', function(){",
  "    var keyword = input.val().replace('1','Ó€');",
  "    // we search in column 4",
  "    table.column(4).search(keyword, true, false).draw();",
  "  });",
  "}"
)

js_callback <- "
  table.column(1).nodes().to$().css({cursor: 'pointer'});
  var format = function(d) {
    return '<div style=\"padding: .5em;\">forms: ' + d[1] + 
           '<br>additional forms: ' + d[2] + 
           '<br>context: ' + d[3] + 
           '<br>meaning: ' + d[4] + '</div>';
  };
  table.on('click', 'td.details-control', function() {
    var td = $(this), row = table.row(td.closest('tr'));
    if (row.child.isShown()) {
      row.child.hide();
      td.html('&oplus;');
    } else {
      row.child(format(row.data())).show();
      td.html('&CircleMinus;');
    }
  });"


read_csv("data/data.csv", show_col_types = FALSE) %>%
  mutate_all(function(i){ifelse(is.na(i), "", i)}) %>% 
  mutate(tooltip = str_c(prs, form2, form3, sep = "; "),
         tooltip = str_remove(tooltip, "^; "),
         tooltip = str_remove(tooltip, ";$"),
         more = '&oplus;',
         tooltip_id = str_c(str_c("kk:&nbsp;", kk), 
                            str_c("jena200:&nbsp;", jena200), 
                            str_c("gld110:&nbsp;", gld110), sep = " "),
         id = glue('<a href="#" data-tooltip data-tooltip-message="{tooltip_id}">{id}</a>')) %>% 
  select(more, tooltip, additional_forms, meaning, context, id, Russian, English, orthography, transcription, pos) %>% 
  datatable(filter = 'top', rownames = FALSE, escape = FALSE,
            colnames = c("", "tooltip", "additional_forms", "meaning", "context", "id", "Russian", "English", "orthography", "transcription", "pos"),
            options = list(pageLength = 10, dom = 'top', 
                           initComplete = JS(js_initComplete),
                           columnDefs = list(
                             list(visible = FALSE, targets = c(1, 2, 3, 4)),
                             list(orderable = FALSE, className = 'details-control', targets = 0))),
            callback = JS(js_callback))
```


